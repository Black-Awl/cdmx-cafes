---
import { AIRTABLE_API_KEY, AIRTABLE_BASE_ID, AIRTABLE_TABLE_NAME } from '../config';
---

<div id="map"></div>
<div id="loading">Loading data...</div>

<script define:vars={{ AIRTABLE_API_KEY, AIRTABLE_BASE_ID, AIRTABLE_TABLE_NAME }}>
  // Airtable configuration
  const Airtable = window.Airtable;
  Airtable.configure({
    apiKey: AIRTABLE_API_KEY
  });
  const base = Airtable.base(AIRTABLE_BASE_ID);

  // Initialize the map
  const map = new maplibregl.Map({
    container: 'map',
    style: 'https://api.maptiler.com/maps/basic/style.json?key=YOUR_MAPTILER_KEY',
    center: [-99.1332, 19.4326],
    zoom: 12
  });

  // Add navigation controls
  map.addControl(new maplibregl.NavigationControl());

  // Custom icons
  const icons = {
    roaster: '/icons/roaster.png',
    cafe: '/icons/cafe.png',
    laptop_friendly: '/icons/laptop_friendly.png'
  };

  let coffeeShops = [];

  // Function to add markers
  function addMarkers(data) {
    // ... (same as before)
  }

  // Function to update markers based on filters
  function updateMarkers() {
    // ... (same as before)
  }

  // Add event listeners to filters
  document.querySelectorAll('#filters input').forEach(input => {
    input.addEventListener('change', updateMarkers);
  });

  // Fetch data from Airtable
  function fetchData() {
    // ... (same as before)
  }

  // Load icons and fetch data
  map.on('load', () => {
    // ... (same as before)
  });
</script>

<style>
  #map {
    width: 100%;
    height: 100vh;
  }
  #loading {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 10px;
    border-radius: 5px;
    z-index: 2;
  }
</style>